# 📖 Spooky Vocab 用户指南

## 🚀 快速开始

### 1. 安装扩展

1. 打开Chrome浏览器
2. 访问 `chrome://extensions/`
3. 开启右上角"**开发者模式**"
4. 点击"**加载已解压的扩展程序**"
5. 选择 `extension` 文件夹
6. 确认扩展已加载并启用

### 2. 启动后端服务器

```bash
cd backend
npm install  # 首次运行
npm start
```

**服务器地址：** `http://localhost:3000`

### 3. 首次登陆

#### 方法一：通过Popup登陆
1. 点击浏览器工具栏的 **Spooky Vocab** 图标
2. 看到"未登陆"提示
3. 点击"**点击登陆**"链接
4. 在登陆页面输入：
   - **用户ID**：任意字母数字组合（如：`john_doe`）
   - **英语水平**：选择你的CEFR等级（默认B1）
5. 点击"**登陆**"按钮
6. 登陆成功！🎉

#### 方法二：直接打开登陆页面
1. 在Chrome中打开：`chrome-extension://[扩展ID]/login/login.html`
2. 或者右键扩展图标 → 管理扩展 → 找到登陆入口

---

## 🎨 界面介绍

### 登陆页面
<kbd>👻 Spooky Vocab</kbd>

**功能：**
- 输入用户ID获取JWT token
- 选择英语水平（A1-C2）
- 测试开发模式，无需真实密码
- 自动保存登陆信息

**字段说明：**
- **用户ID**：唯一标识符，只能包含字母、数字和下划线
- **英语水平**：
  - A1 - 初学者
  - A2 - 基础
  - B1 - 中级（默认）
  - B2 - 中高级
  - C1 - 高级
  - C2 - 精通

### Popup界面
<kbd>扩展弹窗</kbd>

**显示内容：**
- 用户信息（ID和CEFR等级）
- 本次会话统计
  - 遇到的生词数量
  - 标记为已知的数量
- 英语水平快速切换
- 已掌握的词汇列表
- 启用/禁用插件开关

**快捷操作：**
- 点击等级按钮可快速切换英语水平
- 点击"清除历史记录"清空本地数据

### Settings设置页面
<kbd>⚙️ 详细配置</kbd>

访问方式：
1. 右键扩展图标 → 选项
2. 或在Popup中点击"设置"按钮
3. 或访问：`chrome://extensions/` → Spooky Vocab → 详细信息 → 扩展程序选项

**设置项：**

#### 1. API服务器
- **API Base URL**：配置后端服务器地址
- **快速选择**：
  - 本地开发：`http://localhost:3000`
  - 本地5000端口：`http://localhost:5000`
  - 生产环境：`https://api.spookyvocab.com`
- **测试连接**：验证API是否可用

#### 2. 调试选项
- **启用调试模式**：在控制台显示详细日志
- **使用API模式**：取消勾选将使用离线Mock数据

#### 3. 账号信息
- 当前用户ID
- 英语水平
- 登陆时间
- **退出登陆**：清除token
- **清除所有数据**：重置所有本地数据

---

## 💡 使用场景

### 场景1：浏览英文网站

1. 打开任意英文网站（如BBC News、Medium等）
2. 扩展自动识别页面中的英文单词
3. 根据你的英语水平，难词会被标记（蓝色虚线下划线）
4. **鼠标悬停**在标记的单词上 → 显示翻译浮层
5. 浮层显示：
   - 单词
   - 音标
   - 中文释义
   - 关闭按钮

### 场景2：标记已知单词

**桌面端：**
- 悬停在标记的单词上
- 点击浮层右上角的 **✕** 按钮
- 该单词被标记为"已知"，下次不再显示翻译

**移动端（Kiwi Browser）：**
- 点击标记的单词
- 显示/隐藏翻译浮层
- 点击关闭按钮标记为已知

### 场景3：查询未标记的单词

如果某个单词没有被自动标记，但你想查看翻译：

**桌面端：**
- **双击**该单词
- 强制显示翻译浮层
- 该单词会被标记为"未知"并记录

**移动端：**
- **长按**该单词（500ms）
- 显示翻译浮层

### 场景4：调整英语水平

如果你觉得标记的单词太多或太少：

1. 点击扩展图标打开Popup
2. 在"我的英语水平"区域选择新的等级
3. 刷新页面
4. 扩展会根据新等级重新判断难词

### 场景5：离线使用

如果没有网络或后端服务器未启动：

1. 打开Settings
2. 取消勾选"使用API模式"
3. 保存设置
4. 扩展会自动切换到Mock模式
5. 使用内置的测试词汇数据

### 场景6：切换API服务器

如果需要连接到不同的后端服务器：

1. 打开Settings
2. 在"API Base URL"中输入新地址
3. 点击"测试连接"验证
4. 点击"保存设置"
5. 重新登陆以获取新服务器的token

---

## 🔧 常见问题

### Q1: Popup显示"离线模式"
**原因：**
- 后端服务器未启动
- API URL配置错误
- 没有登陆（没有JWT token）

**解决方法：**
1. 确认后端服务器运行中：`curl http://localhost:3000/health`
2. 检查Settings中的API URL是否正确
3. 重新登陆获取token

### Q2: 页面单词没有被标记
**可能原因：**
1. 扩展未启用（Popup中的开关）
2. 页面还在加载中
3. 页面没有英文内容
4. 英语水平设置过高（所有词都被认为是已知的）

**解决方法：**
1. 检查Popup中的启用开关
2. 刷新页面
3. 尝试降低英语水平（如从C1改为B1）
4. F12查看Console日志

### Q3: 登陆失败
**错误信息：**
```
登陆失败: Failed to fetch
```

**原因：**
- 后端服务器未启动
- API URL错误
- CORS问题

**解决方法：**
1. 启动后端：`cd backend && npm start`
2. 检查Settings中的API URL
3. 查看后端服务器日志

### Q4: 翻译浮层位置不对
**原因：**
- 页面样式冲突
- 浮层位置计算错误

**解决方法：**
1. 尝试滚动页面
2. 刷新页面
3. 这是已知问题，正在优化中

### Q5: 如何重置所有数据？
**步骤：**
1. 打开Settings
2. 滚动到"账号信息"区域
3. 点击"清除所有数据"
4. 确认操作（两次）
5. 所有本地数据将被清除
6. 自动跳转到登陆页面

---

## 🎓 进阶技巧

### 技巧1：多账号切换
可以为不同的英语水平创建不同的账号：
- `user_beginner` (A2)
- `user_intermediate` (B1)
- `user_advanced` (C1)

在登陆页面切换不同账号即可。

### 技巧2：自定义词汇判断
目前使用Mock数据进行词汇判断。待后端完整实现后，可以：
- 根据词频数据
- 根据CEFR等级
- 根据你的学习历史
- 动态调整难度

### 技巧3：查看学习统计
1. 打开Popup
2. 查看"本次会话统计"
3. 查看"已掌握的词汇"列表
4. 后续版本会提供详细的学习报告

### 技巧4：调试模式
开发者或想深入了解运行机制：
1. 打开Settings
2. 勾选"启用调试模式"
3. F12打开开发者工具
4. Console会显示详细日志：
```
[VocabHelper] Initializing...
[JWTManager] Token loaded
[APIClient] Checking 15 words...
[TextProcessor] Processed 127 words
```

### 技巧5：移动端使用
在支持Chrome扩展的移动浏览器（如Kiwi）上：
1. 安装扩展（与桌面端相同）
2. 使用**点击**代替悬停
3. 使用**长按**代替双击
4. 触摸区域更大，更易操作

---

## 🔐 安全说明

### 开发模式
当前使用测试JWT token，**不加密**，仅供开发测试：
- Token明文存储在`chrome.storage.local`
- 后端不验证真实密码
- 适合本地开发和测试

### 生产环境（未来）
正式上线时会集成真实登陆系统：
- 用户名 + 密码认证
- JWT加密和签名
- Token刷新机制
- OAuth第三方登陆

### 数据隐私
- **本地数据**：存储在Chrome扩展的本地存储中
- **后端数据**：存储在SQLite数据库
- **不会上传**：你的浏览记录和页面内容
- **只记录**：你标记的单词和学习统计

---

## 📚 快捷键（计划中）

未来版本将支持：
- `Alt+T`：显示/隐藏所有翻译
- `Alt+D`：启用/禁用扩展
- `Alt+S`：打开设置
- `Ctrl+Shift+?`：显示帮助

---

## 🆘 获取帮助

### 问题反馈
- GitHub Issues
- 开发者邮箱

### 文档
- `README.md` - 项目概述
- `QUICK_START.md` - 快速开始
- `TESTING_GUIDE.md` - 测试指南
- `API_SPECIFICATION.md` - API文档

### 开发者工具
按F12查看Console日志，帮助诊断问题：
```javascript
// 查看配置
console.log(CONFIG);

// 查看JWT manager
console.log(jwtManager);

// 测试API
apiClient.getStats().then(console.log);
```

---

## 🎉 享受学习！

Spooky Vocab让英语学习变得更智能、更高效！

**Happy Learning! 👻📖**

